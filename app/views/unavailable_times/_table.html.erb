<table class="mt-8 w-full text-sm text-left text-gray-500 dark:text-gray-400">
  <thead class="text-xs md:text-sm text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
    <tr>
      <th class="px-6 py-3 w-12">Kode Guru</th>
      <th class="px-6 py-3">Nama Guru</th>
      <th class="px-6 py-3">Hari & Jam</th>
      <th class="px-6 py-3">Aksi</th>
    </tr>
  </thead>
  <tbody>
    <% @teachers.each do |teacher| %>
      <% next if teacher.unavailable_times.empty? %>

      <% grouped_by_day = teacher.unavailable_times.group_by { |ut| ut.time_block.day.name } %>
      <% hari_dan_jam = grouped_by_day.map do |day_name, uts| 
        jam = uts.map { |ut| ut.time_block.time }.join(', ')
        "#{day_name}: #{jam}"
      end.join('<br>') %>

      <tr class="border-b text-gray-800 dark:border-gray-700 text-xs md:text-sm">
        <td class="px-6 py-4"><%= teacher.teacher_code %></td>
        <td class="px-6 py-4"><%= teacher.nama %></td>
        <td class="px-6 py-4"><%= raw hari_dan_jam %></td>
        <td class="px-6 py-4 flex items-center space-x-2">
          <%= link_to edit_unavailable_time_path(teacher.id), data: { turbo_stream: true } do %>
            <svg class="w-6 h-6 text-yellow-400 dark:text-white transition hover:scale-110 hover:text-yellow-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"/>
            </svg>
          <% end %>

          <%= link_to unavailable_time_path(teacher.id), data: { 
                turbo_method: :delete,
                turbo_confirm: "Anda yakin ingin menghapus data?" 
              } do %>
            <svg class="w-6 h-6 transition hover:scale-110 text-red-500 dark:text-white hover:text-red-700" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"/>
            </svg>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>

</table>
